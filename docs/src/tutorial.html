<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="Content-Style-Type" content="text/css" />
  <meta name="generator" content="pandoc" />
  <meta name="author" content="Lujing Cen" />
  <title>Tutorial</title>
  <style type="text/css">code{white-space: pre;}</style>
  <link rel="stylesheet" href="template/template.css" type="text/css" />
  <script src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS_CHTML-full" type="text/javascript"></script>
</head>
<body>
    <div class="navbar navbar-static-top">
    <div class="navbar-inner">
      <div class="container">
        <span class="doc-title">Tutorial</span>
        <ul class="nav pull-right doc-info">
                    <li><p class="navbar-text">Lujing Cen</p></li>
                              <li><p class="navbar-text">7/30/2016</p></li>
                  </ul>
      </div>
    </div>
  </div>
    <div class="container">
    <div class="row">
            <div id="TOC" class="span3">
        <div class="well toc">
        <ul>
          <li class="nav-header">Table of Contents</li>
        </ul>
        <ul>
        <li><a href="#introduction">Introduction</a><ul>
        <li><a href="#warnings">Warnings</a></li>
        <li><a href="#read-me">Read Me</a></li>
        <li><a href="#prerequisites">Prerequisites</a></li>
        </ul></li>
        <li><a href="#definitions">Definitions</a><ul>
        <li><a href="#coordinate-system">Coordinate System</a></li>
        <li><a href="#vocabulary">Vocabulary</a></li>
        </ul></li>
        <li><a href="#leg-design">Leg Design</a><ul>
        <li><a href="#alignment">Alignment</a></li>
        <li><a href="#considerations">Considerations</a></li>
        </ul></li>
        <li><a href="#kinematics">Kinematics</a><ul>
        <li><a href="#forward-kinematics">Forward Kinematics</a></li>
        <li><a href="#inverse-kinematics">Inverse Kinematics</a></li>
        <li><a href="#finesse-class">Finesse (class)</a></li>
        </ul></li>
        <li><a href="#servos">Servos</a><ul>
        <li><a href="#configuration">Configuration</a></li>
        <li><a href="#information">Information</a></li>
        <li><a href="#servo-class">Servo (class)</a></li>
        </ul></li>
        <li><a href="#mini-maestro">Mini Maestro</a><ul>
        <li><a href="#protocol">Protocol</a></li>
        <li><a href="#usc">USC</a></li>
        <li><a href="#synchronization">Synchronization</a></li>
        <li><a href="#maestro-class">Maestro (class)</a></li>
        </ul></li>
        <li><a href="#movement">Movement</a><ul>
        <li><a href="#vectors">Vectors</a></li>
        <li><a href="#gait-types">Gait Types</a></li>
        <li><a href="#gait-generation">Gait Generation</a></li>
        <li><a href="#gait-execution">Gait Execution</a></li>
        <li><a href="#center-of-mass">Center of Mass</a></li>
        <li><a href="#static-optimization">Static Optimization</a></li>
        <li><a href="#dynamic-optimization">Dynamic Optimization</a></li>
        <li><a href="#dynamic-class">Dynamic (class)</a></li>
        <li><a href="#agility-class">Agility (class)</a></li>
        </ul></li>
        <li><a href="#vision">Vision</a><ul>
        <li><a href="#tracking">Tracking</a></li>
        <li><a href="#detection">Detection</a></li>
        <li><a href="#slam">SLAM</a></li>
        <li><a href="#optimization">Optimization</a></li>
        <li><a href="#oculus-class">Oculus (class)</a></li>
        <li><a href="#theia-class">Theia (class)</a></li>
        </ul></li>
        <li><a href="#audio">Audio</a><ul>
        <li><a href="#concepts">Concepts</a></li>
        <li><a href="#lykos">Lykos</a></li>
        </ul></li>
        <li><a href="#automation">Automation</a><ul>
        <li><a href="#synthesis">Synthesis</a></li>
        <li><a href="#decision-making">Decision Making</a></li>
        <li><a href="#ares-class">Ares (class)</a></li>
        </ul></li>
        <li><a href="#communication">Communication</a><ul>
        <li><a href="#workers">Workers</a></li>
        <li><a href="#networking">Networking</a></li>
        <li><a href="#cerebral-class">Cerebral (class)</a></li>
        </ul></li>
        <li><a href="#control">Control</a><ul>
        <li><a href="#considerations-1">Considerations</a></li>
        <li><a href="#phi-class">Phi (class)</a></li>
        </ul></li>
        <li><a href="#material-selection">Material Selection</a><ul>
        <li><a href="#body">Body</a></li>
        <li><a href="#legs">Legs</a></li>
        </ul></li>
        <li><a href="#component-selection">Component Selection</a><ul>
        <li><a href="#servos-1">Servos</a></li>
        <li><a href="#steppers">Steppers</a></li>
        <li><a href="#microcontroller">Microcontroller</a></li>
        <li><a href="#battery">Battery</a></li>
        <li><a href="#camera">Camera</a></li>
        </ul></li>
        <li><a href="#electrical">Electrical</a><ul>
        <li><a href="#amperage-draw">Amperage Draw</a></li>
        <li><a href="#safety">Safety</a></li>
        <li><a href="#battery-1">Battery</a></li>
        </ul></li>
        </ul>
        </div>
      </div>
            <div class="span9">
            <h1 id="introduction">Introduction</h1>
<p>Are you trying to build a quadruped robot? Are you trying to understand code in this repository? If you answered yes to either question, you are in the right place. This tutorial will provide a comprehensive guide for building a quadruped robot while providing details on how important pieces of code in this repository function and relate to their conceptual counterparts.</p>
<h3 id="warnings">Warnings</h3>
<p>This guide is in no way comprehensive. I am not accountable for errors in this document. Don't let this guide prevent you from thinking of new designs, concepts, and algorithms. Remember that I am no expert on this subject. Your ideas could very well be better than mine. At the same time, don't attempt to reinvent the wheel. If something is efficient and works for your purpose, use it.</p>
<p>&quot;Premature optimization is the root of all evil.&quot; Test and measure. Don't guess.</p>
<h3 id="read-me">Read Me</h3>
<p>While researching, I chanced upon the <em>Springer Handbook of Robotics</em>. Before proceeding, read section 16.5 of the book found <a href="http://home.deib.polimi.it/gini/robot/docs/legged.pdf">here</a>. If you are serious about robotics, I recommend that you find this book in the library or get an eBook. This book basically covers everything you need to know about advanced robotics and even provides historical background. You probably won't understand everything in this literature. That is completely okay. This is just an introduction.</p>
<h3 id="prerequisites">Prerequisites</h3>
<p>Trying to accomplish this project requires that you are not scared of math and physics. You will need a strong foundation in geometry, trigonometry, algebra, classical mechanics, and prelimiary linear algebra. You will also need a deep understanding of calculus, although you might not ever need to take a derivative in this project. It would help that you also understand some practical electricity and magnetism.</p>
<h1 id="definitions">Definitions</h1>
<p>It is important to define everything before starting this project. It will save you a lot of time. Don't invent your own coordinate system like me and waste 2 weeks :p.</p>
<h3 id="coordinate-system">Coordinate System</h3>
<p>The world runs on the right-handed coordinate system. Being left-handed, I accidentally used the left-handed coordinate system, which ended up causing me a lot of confusion. Don't be like me. Clearly define the coordinate system before beginning. This is not to say you can't use the left-handed system. Just make sure you know what you're doing, because pretty much everything on the internet uses the right-handed system.</p>
<div class="figure">
<img src="assets/table.jpg" />

</div>
<p>Pretend the robot is a table. The head points in the positive x direction. The left side points in the positive y direction. The top of the table points to the positive z axis. The image is there for clarification.</p>
<h3 id="vocabulary">Vocabulary</h3>
<dl>
<dt>End Effector</dt>
<dd>In kinematics, the end of a robotic arm or leg. In this case, it is the tip of the feet.
</dd>
<dt>Root</dt>
<dd>In kinematics, the point at which the arm or leg attaches to the body.
</dd>
</dl>
<h1 id="leg-design">Leg Design</h1>
<h3 id="alignment">Alignment</h3>
<h3 id="considerations">Considerations</h3>
<h1 id="kinematics">Kinematics</h1>
<p>This is perhaps the most math intensive and important portion of the project.</p>
<h3 id="forward-kinematics">Forward Kinematics</h3>
<h3 id="inverse-kinematics">Inverse Kinematics</h3>
<h3 id="finesse-class">Finesse (class)</h3>
<h1 id="servos">Servos</h1>
<h3 id="configuration">Configuration</h3>
<h3 id="information">Information</h3>
<h3 id="servo-class">Servo (class)</h3>
<h1 id="mini-maestro">Mini Maestro</h1>
<h3 id="protocol">Protocol</h3>
<h3 id="usc">USC</h3>
<h3 id="synchronization">Synchronization</h3>
<h3 id="maestro-class">Maestro (class)</h3>
<h1 id="movement">Movement</h1>
<p>We want to translate user inputs of rotational motion (<span class="math inline">\(rad / sec\)</span>) and forward motion (<span class="math inline">\(cm / sec\)</span>) to physical robot motion. The first challenge is to use <span class="math inline">\(d\theta\)</span>, the amount of rotation per cycle, and <span class="math inline">\(dv\)</span>, the amount of forward motion per cycle, to generate proper gaits. The second challenge is to perform various gait optimizations to ensure that the robot walks smoothly.</p>
<h3 id="vectors">Vectors</h3>
<p>My friend Alastair MacMillan came up with this amazing idea one day that basically made complex motion possible. For a moment, pretend that the robot is just a rectangle.</p>
<div class="center">
<p><img src="assets/vector.png" />Â <img src="assets/vector1.png" /></p>
</div>
<p>The verticies or legs are number 0-3 accordingly. To rotate the rectangle, we can simply apply a vector at each vertex. The cool thing about vectors is that they can be view as separate components. To add forward or backward movement, simply add to the x component.</p>
<p>The easiest method to physically reproduce the vector is to compute <span class="math inline">\((x, y)\)</span> and generate a line between <span class="math inline">\((x, y)\)</span> and <span class="math inline">\((-x, -y)\)</span>. Moving one cycle along the line will be twice the desired vector.</p>
<p>The harder part is using <span class="math inline">\(\theta\)</span> to find <span class="math inline">\(x\)</span> and <span class="math inline">\(y\)</span>. At every instantaneous moment in time, each leg applies a force. Relative to their respective roots the force is linear over time. However, when all four legs work together, the linear force becomes rotational.</p>
<div class="figure">
<img src="assets/vector2.png" />

</div>
<p>We define the width <span class="math inline">\(w\)</span> to be the distance along y and length <span class="math inline">\(l\)</span> to be the distance along x. Let <span class="math inline">\(u\)</span> be a matrix or width and length. The magnitude of the vector is defined to be <span class="math inline">\(|\Delta|\)</span> and the radius of the circle is <span class="math inline">\(r\)</span>. A few things become immediately evident.</p>
<p><span class="math display">\[r = \frac{1}{2} \sqrt{w^2 + l^2}\]</span> <span class="math display">\[|\Delta| = \sqrt{x^2 + y^2}\]</span> <span class="math display">\[u = \begin{bmatrix} w \\ l \end{bmatrix}\]</span></p>
<p><span class="math inline">\(\theta\)</span>, how much the robot will turn when the leg moves <span class="math inline">\(\Delta\)</span>, is between <span class="math inline">\(r\)</span> and the hypotenuse. It can be solved using inverse tangent.</p>
<p><span class="math display">\[\theta = \arctan \left(\frac{|\Delta|}{r}\right)\]</span></p>
<p>The desired theta input is twice of that. So the input <span class="math inline">\(d\theta = 2 \times \theta\)</span>. We can then solve for <span class="math inline">\(|\Delta|\)</span>.</p>
<p><span class="math display">\[|\Delta| = r \times \tan \left(\frac{1}{2} d\theta \right)\]</span></p>
<p>The <span class="math inline">\((x, y)\)</span> contribution from the rotation part is always perpendicular to the line from the center to the vertex. This means that we can use the <a href="https://en.wikipedia.org/wiki/Unit_vector">normalized vector</a> <span class="math inline">\(\hat{u}\)</span> to find the desired values. Finally, add the desired rotational contribution value for <span class="math inline">\(dv\)</span>.</p>
<p><span class="math display">\[\begin{bmatrix} x \\ y \end{bmatrix} = |\Delta| \times \hat{u} + \begin{bmatrix}dv \\ 0 \end{bmatrix}\]</span></p>
<h3 id="gait-types">Gait Types</h3>
<p>There are various gait types described in <em>Springer Handbook of Robotics</em>. However, I believe that trot and crawl are the two easier gaits to implement. Obviously, trot is much faster than crawl. However, testing should reveal the optimal transition speed and time. If both are graphed, if can be seen that this is an optimization problem. I did not have sufficient time to test thoroughly. However, if time <span class="math inline">\(t\)</span> can be found, it is easy to convert <span class="math inline">\(rad / sec\)</span> and <span class="math inline">\(cm / sec\)</span> to <span class="math inline">\(d\theta\)</span> and <span class="math inline">\(dv\)</span>.</p>
<p><span class="math display">\[\begin{bmatrix} d\theta \\ dv \end{bmatrix} = t \times \begin{bmatrix} rad/sec \\ cm/sec \end{bmatrix}\]</span></p>
<p>I have not found significant differences between different leg orderings. However, this is because I have not done extensive testing. The robots use 1423 creeping gaits, although the other orderings work as well.</p>
<h3 id="gait-generation">Gait Generation</h3>
<h3 id="gait-execution">Gait Execution</h3>
<h3 id="center-of-mass">Center of Mass</h3>
<h3 id="static-optimization">Static Optimization</h3>
<h3 id="dynamic-optimization">Dynamic Optimization</h3>
<h3 id="dynamic-class">Dynamic (class)</h3>
<h3 id="agility-class">Agility (class)</h3>
<h1 id="vision">Vision</h1>
<h3 id="tracking">Tracking</h3>
<h3 id="detection">Detection</h3>
<h3 id="slam">SLAM</h3>
<h3 id="optimization">Optimization</h3>
<h3 id="oculus-class">Oculus (class)</h3>
<h3 id="theia-class">Theia (class)</h3>
<h1 id="audio">Audio</h1>
<h3 id="concepts">Concepts</h3>
<h3 id="lykos">Lykos</h3>
<h1 id="automation">Automation</h1>
<h3 id="synthesis">Synthesis</h3>
<h3 id="decision-making">Decision Making</h3>
<h3 id="ares-class">Ares (class)</h3>
<h1 id="communication">Communication</h1>
<h3 id="workers">Workers</h3>
<h3 id="networking">Networking</h3>
<h3 id="cerebral-class">Cerebral (class)</h3>
<h1 id="control">Control</h1>
<h3 id="considerations-1">Considerations</h3>
<h3 id="phi-class">Phi (class)</h3>
<h1 id="material-selection">Material Selection</h1>
<h3 id="body">Body</h3>
<h3 id="legs">Legs</h3>
<h1 id="component-selection">Component Selection</h1>
<h3 id="servos-1">Servos</h3>
<h3 id="steppers">Steppers</h3>
<h3 id="microcontroller">Microcontroller</h3>
<h3 id="battery">Battery</h3>
<h3 id="camera">Camera</h3>
<h1 id="electrical">Electrical</h1>
<h3 id="amperage-draw">Amperage Draw</h3>
<h3 id="safety">Safety</h3>
<h3 id="battery-1">Battery</h3>
            </div>
    </div>
  </div>
</body>
</html>
